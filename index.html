<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded Google Drive Folder</title>
</head>
<body>

<div id="drive-viewer"></div>

<script>
    // Replace 'YOUR_FOLDER_ID' with the actual folder ID from your Google Drive URL
    const folderId = '1VrgMsJ2BjIg7VDB6TkBd5AsAK6UMLsKM';

    // Create the embed code
    const embedCode = `<iframe id="drive-iframe" src="https://drive.google.com/embeddedfolderview?id=${folderId}#grid" width="100%" height="600" frameborder="0"></iframe>`;

    // Display the embed code in the 'drive-viewer' div
    document.getElementById('drive-viewer').innerHTML = embedCode;

    // Add a click event listener to the iframe
    const iframe = document.getElementById('drive-iframe');
    iframe.addEventListener('load', function() {
        // Access the contentDocument of the iframe
        const iframeDocument = iframe.contentDocument;

        // Add click event listeners to all links within the iframe
        const links = iframeDocument.querySelectorAll('a');
        links.forEach(link => {
            link.addEventListener('click', function(event) {
                event.preventDefault();
                const fileId = link.getAttribute('data-id');
                displayFile(fileId);
            });
        });
    });

    function displayFile(fileId) {
        // You may customize this part based on the file type or use third-party libraries for better handling
        const fileUrl = `https://drive.google.com/file/d/${fileId}/view?usp=drivesdk`;
        iframe.src = fileUrl;
    }
</script>

</body>
</html>
